<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" /> 
  <title></title>
  <style>
  body{
    margin: 0;
    overflow: hidden;
  }
  </style>
</head>
<body onload="go()">
<script type="text/javascript" src='../js/three81.js'></script>
<script type="text/javascript" src='../js/FirstPersonControls.js'></script>
<script>
var renderer,camera,scene,obj,matetial,geometry
var wiW=window.innerWidth,wiH=window.innerHeight
  function init() {
    renderer=new THREE.WebGLRenderer()
    renderer.setSize(wiW,wiH)
    renderer.setClearColor('black')
    document.body.appendChild(renderer.domElement)
    scene=new THREE.Scene()
    camera=new THREE.PerspectiveCamera(45,wiW/wiH,0.1,1000)
    camera.position.z=160
     camera.position.y=10
    Trackball=new THREE.FirstPersonControls(camera)
    var map1=new THREE.Texture(canvas1())
    map1.needsUpdate=true
    geometry=[
    new THREE.BoxGeometry(2,2,2),
    new THREE.Geometry(),
    new THREE.BufferGeometry()
    ]
    var c=new THREE.GridHelper(1000,600)
    scene.add(c)
    //material
    material=[
    new THREE.MeshBasicMaterial({map:map1,side:THREE.DoubleSide}),
    new THREE.MeshNormalMaterial(),
    new THREE.MeshBasicMaterial({vertexColors:THREE.VertexColors,side:THREE.DoubleSide}),
    new THREE.MeshBasicMaterial({color:'green'})
    ]
var pt=3000
for(var i=0;i<pt;i++){
  geometry[1].vertices.push(new THREE.Vector3(Math.random()*2000-1000, 
  Math.random()*2000-1000,Math.random()*2000-1000  ))
geometry[1].colors.push(new THREE.Color(Math.random()*0xffffff))
}
cube=new THREE.Points(geometry[1],new THREE.PointsMaterial({size:10,vertexColors:THREE.VertexColors}))
  geometry=new THREE.BoxGeometry(2,2,2)
  for(var i=0;i<80;i++){
   var c=new THREE.Mesh(geometry,material[3])
   c.position.set(Math.random()*1000-500,Math.random()*1000-500,Math.random()*1000-500)
   scene.add(c)
  }
  window.addEventListener('resize',windowResize,false)
}
  function render(){
    Trackball.update(0.01)
    renderer.render(scene,camera)
    requestAnimationFrame(render)
  }
  function go(){
    init()
    render()
  }
  function canvas1(){
    var canvas=document.createElement('canvas')
    canvas.width=64
    canvas.height=64
    var c=canvas.getContext('2d')
    c.arc(32,32,32,0,20)
    c.fillStyle='white'
    c.fill()
    document.body.appendChild(canvas)
    return canvas;
  }
  function windowResize(){
    wiW=window.innerWidth
    wiH=window.innerHeight
    renderer.setSize(wiW,wiH)
    camera.aspect=wiW/wiH
    camera.updateProjectionMatrix()
  }
</script>
</body>
</html>
